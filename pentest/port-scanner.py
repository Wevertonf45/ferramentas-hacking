#Importações de bibliotecas
import socket
import pyfiglet

texto = pyfiglet.figlet_format('Port Scanner', font='slant')
largura = 100
altura = 7

print("*" * largura)
for i in range(altura - 2):
    if i == (altura - 2)//2:
        print("" + texto.center(largura - 2) + "")
    else:
        print("" + " " * (largura - 2) + "")
print("*" * largura)


#Inicia port scanner
target_host = input('Enter a host to scan: ', '\n')

for port in range(1, 65536):
    connect = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connect.settimeout(1)

    code = connect.connect_ex((target_host, port))
    if code == 0:
        print('Port {} is open'.format(port))
    else:
        print('Port {} is closed'.format(port))
    connect.close()

#80, 443, 8080, 8443, 3000, 5000, 8000, 8888, 9080, 9443, 3306, 5432, 1521, 1433, 27017, 6379, 9200, 11211, 27018, 27019, 25, 465, 587, 110, 995, 143, 993, 22, 21, 20, 989, 990, 23, 3389, 5900, 5985, 5986, 161, 162, 137, 138, 139, 445, 1883, 8883, 15672, 5672, 9092, 2181, 2375, 2376, 6443, 10250, 53, 123, 67, 68, 179, 5601, 8081, 9090, 9100, 10000, 3001, 5173, 5174